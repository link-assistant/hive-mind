{"author":{"id":"MDQ6VXNlcjE0MzE5MDQ=","is_bot":false,"login":"konard","name":"Konstantin Diachenko"},"body":"## Summary\n\nThis PR implements the **bidirectional interactive mode** feature requested in issue #817. The goal is to enable real-time communication between users and Claude during execution by:\n\n1. **Monitoring PR comments** for user feedback during Claude execution\n2. **Queueing feedback messages** for potential use in subsequent runs\n3. **Filtering out system-generated comments** to avoid processing bot messages\n4. **Reporting collected feedback** at the end of execution\n\n### Key Features\n\n- **New `--bidirectional-interactive` CLI option** for both `solve` and `hive` commands\n- **Comment monitoring** with configurable poll interval (default: 15 seconds)\n- **Smart system comment detection** to ignore interactive mode output\n- **Feedback queue** with FIFO processing and state tracking\n- **Comprehensive unit tests** with 27 passing test cases\n\n### Technical Implementation\n\nThe implementation uses Claude CLI's `--input-format stream-json` capability (discovered during research) to format feedback messages in a format ready for injection. While full real-time stdin injection would require deeper architectural changes, this PR establishes the foundational infrastructure:\n\n1. `src/bidirectional-interactive.lib.mjs` - New module with:\n   - `createBidirectionalHandler()` - Factory function for feedback queue management\n   - `isSystemComment()` - Detects and filters system-generated comments\n   - `formatFeedbackForClaude()` - Formats feedback in Claude's stream-json format\n   - `validateBidirectionalModeConfig()` - Configuration validation\n\n2. Updated `src/claude.lib.mjs`:\n   - Integration with bidirectional handler during execution\n   - Proper cleanup and feedback reporting on completion\n   - Returns queued feedback in execution result\n\n3. Updated CLI configurations:\n   - `src/solve.config.lib.mjs` - Added `--bidirectional-interactive` option\n   - `src/hive.config.lib.mjs` - Added `--bidirectional-interactive` option\n\n### Usage\n\n```bash\n# Enable bidirectional mode (automatically enables --interactive-mode)\nsolve https://github.com/owner/repo/issues/123 --bidirectional-interactive\n\n# Use with hive command\nhive https://github.com/owner/repo --bidirectional-interactive\n```\n\n### Future Enhancements\n\nThis PR establishes the foundation. Future work could include:\n- Real-time stdin injection during Claude execution (requires deeper changes to command execution model)\n- Automatic continuation with queued feedback\n- Priority-based feedback queue\n- Comment thread tracking\n\n## Test Plan\n\n- [x] Unit tests pass: `node tests/test-bidirectional-interactive.mjs` (27/27)\n- [x] Existing interactive mode tests pass: `node tests/test-interactive-mode.mjs` (36/36)\n- [x] ESLint passes: `npm run lint`\n- [ ] Manual testing with real PR\n\nFixes #817\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)","createdAt":"2025-12-05T18:32:36Z","number":843,"state":"OPEN","title":"Implement bidirectional interactive mode for real-time PR feedback","updatedAt":"2025-12-05T19:04:38Z","url":"https://github.com/link-assistant/hive-mind/pull/843"}
